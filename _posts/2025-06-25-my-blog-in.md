---
layout: single
title: "è®²è®²è¿™ä¸ªWinformçš„åŸºç¡€"
date: 2025-06-24 10:00:00 +0800
author: default
categories: [æ•™ç¨‹, Jekyll]
tags: [ç›®å½•, markdown, åšå®¢]
toc: true          # âœ… å¼€å¯ç›®å½•
toc_sticky: true   # âœ… ç›®å½•å›ºå®šåœ¨ä¾§è¾¹æ 
toc_label: "ç›®å½•"  # âœ… å¯è‡ªå®šä¹‰æ ‡é¢˜ï¼Œå¦‚ Table of Contents
toc_icon: "list-ul"
comments: true     # âœ… å¦‚æœä½ å¼€å¯äº†è¯„è®ºç³»ç»Ÿ
read_time: true    #æ˜¾ç¤ºæ—¶é—´
header:
  teaser: /assets/img/logo.png    
---

>  **è¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ¥è®²C# Winform+DevExpressçš„åŸºç¡€å¢åˆ æ”¹æŸ¥å’Œç™»å½•ç³»ç»Ÿ**

---

## ğŸ“ æ­£æ–‡å†…å®¹å¼€å§‹

### ä¸€ã€C# Winformæ˜¯ä»€ä¹ˆ?

C# WinFormï¼ˆWindows Formsï¼‰æ˜¯å¾®è½¯åŸºäº.NET Frameworkå¹³å°å¼€å‘çš„ä¸€å¥—ç”¨äºåˆ›å»ºâ€‹â€‹Windowsæ¡Œé¢åº”ç”¨ç¨‹åºâ€‹â€‹çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰æŠ€æœ¯

### äºŒã€DevExpressæ˜¯ä»€ä¹ˆ?

DevExpressï¼ˆDeveloper Express Inc.ï¼‰æ˜¯ä¸€å®¶ä¸“æ³¨äºä¸º.NETå¼€å‘è€…æä¾›â€‹â€‹é«˜æ€§èƒ½UIæ§ä»¶å’Œå¼€å‘å·¥å…·â€‹â€‹çš„è½¯ä»¶å…¬å¸ï¼Œå…¶äº§å“å¹¿æ³›åº”ç”¨äºæ¡Œé¢ã€WebåŠç§»åŠ¨åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚

### ä¸‰ã€çª—ä½“è®¾è®¡ä¸å¢åˆ æ”¹æŸ¥(CRUD)é€»è¾‘å®ç°

#### 1.å°è£…å·¥å…·ç±»

>ç¯å¢ƒå‡†å¤‡* 
> æœ¬æ•™ç¨‹é»˜è®¤ä½ å·²å…·å¤‡ä»¥ä¸‹å¼€å‘ç¯å¢ƒï¼š
>
> Visual Studio(å»ºè®® 2022 åŠä»¥ä¸Š)
>
> `DevExpress WinForms` ç»„ä»¶
>
> SQL Serverï¼ˆå»ºè®®ä½¿ç”¨ `SSMS` è¿æ¥æ•°æ®åº“ï¼‰
 <p>å¦‚æœªå®‰è£…ç¯å¢ƒï¼Œè¯·å‚é˜…æœ¬ç«™å¦ä¸€ç¯‡æ•™ç¨‹ï¼šã€Šå¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—ã€‹ã€‚</p>
  
 

**ç¡®è®¤å¥½ç¯å¢ƒé½å…¨åï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹æˆ‘ä»¬çš„æ•™ç¨‹**

é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¿æ¥æ•°æ®åº“çš„è¿æ¥ä¸²

 **æ³¨æ„ï¼Œè¿™ä¸ªå·¥å…·ç±»éå¸¸é‡è¦ï¼Œæˆ‘ä»¬ä¹‹åå¾ˆå¤šéƒ½ä¼šç”¨åˆ°å®ƒçš„**

{% highlight bash %}
public static string strConn = "server=.;uid=sa;pwd=sa;database=Kuade001";
{% endhighlight %}

> **publicå°±æ˜¯å®šä¹‰å…¬å…±ç±»**    
> **staticé€‰æ‹©ä¸€ä¸ªç±»**  
> **stringå£°æ˜è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²**    
> **ç„¶åå®šä¹‰ä¸€ä¸ªè¿æ¥ä¸²åç§°ä¸ºstrConn**    
> **""é‡Œé¢çš„ç¬¬ä¸€ä¸ªæ˜¯è®¾ç½®ä½ çš„æ•°æ®åº“å¼•æ“æ˜¯ä»€ä¹ˆ**  
> **æˆ‘è¿™ä¸ªæ˜¯é»˜è®¤çš„æœ¬åœ°æ•°æ®åº“é»˜è®¤ä¸º.,uidæ˜¯ä½ çš„ç”¨æˆ·å,pwdä¸ç”¨å¤šè¯´äº†,å°±æ˜¯å¯†ç ,å°±æ˜¯é€‰æ‹©ä½ è¿™ä¸ªæ•°æ®åº“å¼•æ“é‡Œé¢çš„å“ªä¸ªæ•°æ®åº“**

**é—®é¢˜æ¥äº†ï¼Œå…¬å…±ç±»æ˜¯ä»€ä¹ˆ?æ•°æ®åº“å¼•æ“æ˜¯ä»€ä¹ˆ?**

å…¬å…±ç±»å°±æ˜¯è¿™ä¸ªå°è£…çš„ç±»èƒ½è¢«æ‰€æœ‰çš„åœ°æ–¹è°ƒç”¨

ç®€å•æ¥è¯´æ•°æ®åº“å¼•æ“å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é‡Œé¢æœ‰å¾ˆå¤šä¸ªæ•°æ®åº“

å®šä¹‰å®Œæ¯•å­—ç¬¦ä¸²ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨æ¥è¿›è¡Œå†™ä¸€ä¸ªæŸ¥è¯¢ç±»

{% highlight bash %}
  //æŸ¥è¯¢ExecuteQuery
  public static DataTable ExecuteQuery(string strSql, SqlParameter[]parameters) 
  {
      DataTable Result = new DataTable();
      //åˆ›å»ºä¸€ä¸ªæ–°çš„DataTableå¯¹è±¡èµ‹å€¼ç»™Result

      var conn = new SqlConnection(strConn);
      //å®šä¹‰æ•°æ®åº“è¿æ¥
      var dba = new SqlDataAdapter(strSql, conn);
      //ä½¿ç”¨æ•°æ®å¼•æ“å¡«å……æ•°æ®
      dba.SelectCommand.Parameters.AddRange(parameters);

      conn.Open();
      //å¼€å¯æ•°æ®åº“

      //å¡«å……è¿”å›å€¼
      dba.Fill(Result);

      //å…³é—­æ•°æ®åº“
      conn.Close();

      return Result;
      //ç»“æŸæŸ¥è¯¢
  }
{% endhighlight %}

è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªè¿æ¥æ•°æ®åº“æŸ¥è¯¢çš„æ“ä½œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å†™å¢åˆ æ”¹çš„æ“ä½œ

{% highlight bash %}
public static int ExecuteNonQuery(string strSql, SqlParameter[] parameters)
{
    int Result = 0;

    var conn = new SqlConnection(strConn);
    //å®šä¹‰æ•°æ®åº“è¿æ¥

    var cmd = new SqlCommand(strSql,conn);
    //æ·»åŠ æ•°æ®åº“å‘½ä»¤

    cmd.CommandType = CommandType.Text;

    cmd.Parameters.AddRange(parameters);
    //ç»™sqlå‘½ä»¤æ·»åŠ å‚æ•°

    conn.Open();
    //æ‰“å¼€æ•°æ®åº“

    Result = cmd.ExecuteNonQuery();
    //æ‰§è¡Œå‘½ä»¤

    conn.Close();
    //å…³é—­æ•°æ®åº“

    return Result;
}
{% endhighlight %}

è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªåŸºç¡€çš„å¢åˆ æ”¹æŸ¥

#### 2.ç™»å½•çª—ä½“

>æ³¨æ„ï¼Œæ¥ä¸‹æ¥æˆ‘çš„æ•™ç¨‹å°±æ˜¯å»ºç«‹åœ¨é»˜è®¤æœ‰Visual Studio+DevExpress+SQL SERVER(SSMS)çš„ç¯å¢ƒåŸºç¡€ä¸Šï¼Œå¦‚æ²¡æœ‰è¿™ä¸ªç¯å¢ƒè¯·çœ‹æˆ‘å¦å¤–ä¸€ä¸ªå¸–å­

æˆ‘ä»¬ç°åœ¨å¼€å§‹åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®

![](/assets/img/1751003426218.png)

é€‰æ‹©åˆ›å»ºæ–°é¡¹ç›®

![](/assets/img/1751003474967.png)

æœç´¢winformï¼Œç„¶ååœ¨ä¸‹é¢æ‰¾åˆ°winform netframework,æˆ‘ä»¬ç›®å‰å…ˆä½¿ç”¨è¿™ä¸ª

è¿›å…¥ä¸»é¡µä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å¼€å§‹å¸ƒç½®æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç™»å½•é¡µé¢

é¦–å…ˆç»™æˆ‘ä»¬çš„çª—ä½“æ”¹åï¼Œæ³¨æ„WinFormçš„å‘½åè§„èŒƒ

>WinFormçª—ä½“çš„å‘½åè§„èŒƒæ˜¯Frmå¼€å¤´çš„ï¼Œç„¶åä»¥é©¼å³°å¼å‘½åï¼Œæ¯”å¦‚æˆ‘è¦è®¾ç½®ä¸€ä¸ªä¸»é¡µé‚£ä¹ˆå°±è¿™æ ·å†™

**FrmMainForm**


æ”¹åå®Œæˆä¹‹åç°åœ¨å¼€å§‹æˆ‘ä»¬æ¥æ‹–åŠ¨æ§ä»¶å¸ƒç½®ä¸€ä¸ªç™»å½•çš„é¡µé¢

æœç´¢è¿™ä¸‰ä¸ªæ§ä»¶

>Simplebutton,labelControl,textEdit

è¿™ä¸‰ä¸ªåˆ†åˆ«æ˜¯  æŒ‰é’®æ§ä»¶ï¼Œæ–‡å­—æ§ä»¶ï¼Œè¾“å…¥æ¡†æ§ä»¶

æˆ‘ä»¬æ¥ä¸‹æ¥ç»™è¿™ä¸‰ä¸ªæ§ä»¶å‘½åï¼Œæ³¨æ„æ§ä»¶çš„å‘½åè§„èŒƒæ˜¯

>æ§ä»¶çš„ç®€å†™åœ¨å‰é¢ï¼Œåç§°åœ¨åé¢ï¼Œå¦‚æˆ‘æƒ³è¾“å…¥ä¸€ä¸ªç”¨æˆ·åæ§ä»¶å°±è¿™æ ·å†™

**lblUserNo**

è¿™æ ·å°±æ˜¯ä¸€ä¸ªlabelæ§ä»¶çš„ç®€å†™,ä¾æ­¤ç±»æ¨ï¼Œå¦‚æœä¸æ¸…æ¥šæ§ä»¶ç®€å†™å¯ä»¥å»ç½‘ä¸ŠæŸ¥æ‰¾,æˆ‘ä¸‹é¢åˆ—äº†ä¸€ä¸¤ä¸ªç®€å•çš„

|  åç§°  |ç®€å†™|  
|----|----|
|  labelControl  |  lbl  |
|  textedit| txt|
| simplebutton|btn|

>**é¡µé¢å¸ƒå±€ä½ ä»¬è‡ªç”±å‘æŒ¥,è¿™é‡Œæˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œæ»¡è¶³ä¸¤ä¸ªæ–‡æœ¬æ¡†ï¼Œä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œä¸¤ä¸ªæŒ‰é’®å°±è¡Œäº†**

å¥½çš„ï¼Œè®¾ç½®å®Œåç§°ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åŒå‡»æŒ‰é’®è¿›å…¥ä»£ç é¡µè§¦å‘ç‚¹å‡»äº‹ä»¶

æ¥ä¸‹æ¥æˆ‘ä»¬å°†å¼€å§‹å†™ç‚¹å‡»äº‹ä»¶ä¹‹åçš„åˆ¤æ–­

é¦–å…ˆæˆ‘ä»¬å…ˆæ¥è·å–è¾“å…¥æ¡†ä¸­çš„å€¼ç»™ä»–å°è£…æˆåç§°
{% highlight bash %}
var user_no = this.txtUserNo.Text.Trim()
var user_pwd = this.txtUserPwd.Text.Trim()
{% endhighlight %}

è¿™æ ·æˆ‘ä»¬å°±å®šä¹‰çš„ä¸¤ä¸ªåç§°ï¼Œuser_noå’Œuser_pwdä¸ºæˆ‘ä»¬æ¡†ä¸­è·å–åˆ°çš„å€¼

è¿™æ ·çš„è¯ï¼Œåªè¦æˆ‘ä»¬è¾“å…¥ä»€ä¹ˆï¼Œä»–å°±èƒ½æŠŠæˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¾“å‡ºæˆå€¼ä»¥ä¾¿ä¸‹é¢åˆ¤æ–­

æ¥ä¸‹æ¥æˆ‘ä»¬å†™åˆ¤æ–­ä¸ºç©ºæ ¡éªŒ

{% highlight bash %}
if (user_no == "")
{
    MessageBox.Show("ç”¨æˆ·åä¸èƒ½ä¸ºç©º!");
    return;
}

//å‡è®¾æ£€æµ‹åˆ°é‡Œé¢æ²¡æœ‰æ•°æ®ï¼Œå°±æç¤ºç”¨æˆ·åä¸èƒ½ä¸ºç©º!å¹¶åœæ­¢ç¨‹åº

if (user_pwd == "")
{
    MessageBox.Show("ç”¨æˆ·åä¸èƒ½ä¸ºç©º!");
    return;
}
{% endhighlight %}

è¿™é‡Œä½¿ç”¨ifæ¥åˆ¤æ–­è¿™é‡Œé¢çš„å€¼æ˜¯å¦ä¸ºç©ºï¼Œå¦‚ä½•ä¸ºç©ºå°±å¼¹å‡ºMessageBoxå¼¹çª—æ˜¾ç¤ºç”¨æˆ·åæˆ–è€…å¯†ç ä¸èƒ½ä¸ºç©ºå¹¶ä¸”ç»ˆæ­¢ç¨‹åº

å†™å®Œç©ºå€¼åˆ¤æ–­ä¹‹åï¼Œå¼€å§‹å¼•ç”¨æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„ExecuteQuery(æŸ¥è¯¢)å’ŒExecuteNonQuery(å¢åˆ æ”¹)è¿›è¡Œæ•°æ®åº“æ“ä½œ,æˆ‘ä»¬ä½¿ç”¨LINQçš„è¯­æ³•æ¥è¿›è¡Œæ“ä½œæ•°æ®åº“

{% highlight bash %}
List<SqlParameter> parameters = new List<SqlParameter>();
//åˆ›å»ºå‚æ•°åˆ—è¡¨
parameters.Add(new SqlParameter { ParameterName = "user_no", Value = user_no, DbType = DbType.String }); //DbType = DbType.StringæŒ‡å®šæ•°æ®ç±»å‹
parameters.Add(new SqlParameter { ParameterName = "user_pwd", Value = user_pwd, DbType = DbType.String });
var dt = SqlHelper.ExecuteQuery($@"select * from UserInfo where user_no=@user_no and user_pwd=@user_pwd",parameters.ToArray());//å®šä¹‰å‚æ•°ï¼ŒæŠŠå‚æ•°ä¼ ç»™ToArrayå®¿ä¸»
if (dt != null && dt.Rows.Count > 0) //å‡å¦‚æ£€æµ‹åˆ°è¿™ä¸ªdtå€¼ä¸ç­‰äºnullå¹¶ä¸”åœ¨æ•°æ®åº“çš„è¡Œå¤§äº0æ‰§è¡Œä»¥ä¸‹å‘½ä»¤
{
    this.Hide();

    var frm = new FrmMainForm();
    frm.ShowDialog();

    this.Close();
}
else //æ£€æµ‹ä¸åˆ°åˆ™æç¤ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
{
    MessageBox.Show("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!");
    return;
}
{% endhighlight %}

> **é¦–å…ˆè¿›è¡Œåˆ›å»ºå‚æ•°åˆ—è¡¨ï¼Œä¼ å…¥å ä½ç¬¦çš„å€¼ï¼Œç„¶åè¿›è¡Œæ•°æ®åº“æ“ä½œæŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç **
> **æŸ¥è¯¢å®Œæ¯•ä¹‹åå¼€å§‹åˆ¤æ–­æˆ‘è¾“å…¥çš„åˆ—æ˜¯å¦åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œå¦‚å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ª>0**
> **å¦‚å­˜åœ¨ï¼Œå°±éšè—è¿™ä¸ªç™»å½•çª—ä½“ï¼Œæ‰“å¼€æˆ‘ä»¬çš„ä¸»é¡µçª—ä½“ï¼Œæ‰“å¼€ä¹‹åï¼ŒåŒæ—¶å…³é—­æˆ‘ä»¬çš„ç™»å½•çª—ä½“**
> **å¦‚ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°±å¼¹å‡ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯å¹¶ç»ˆæ­¢æ¥ä¸‹æ¥çš„é€»è¾‘**

#### 3.æ³¨å†Œçª—ä½“

ç™»å½•çª—ä½“å†™å®Œä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¼€å§‹å†™æ³¨å†Œçª—ä½“ï¼Œè·Ÿç™»å½•ä¸€æ ·ï¼Œå¤šæ‹–ä¸¤ä¸ªlabelæ§ä»¶å’Œtexteditæ§ä»¶ä¾¿äºå†™å§“åå’Œé‡å¤å¯†ç åˆ¤æ–­

{% highlight bash %}
var user_no = this.txtUserNo.Text.Trim();
//è·å–çª—ä½“txtUserNoæ§ä»¶ä¸­çš„æ•°æ®å¹¶è®¾ä¸ºuser_no
var user_name = this.txtUserName.Text.Trim();
//è·å–çª—ä½“txtUserNameæ§ä»¶ä¸­çš„æ•°æ®å¹¶è®¾ä¸ºuser_name
var user_pwd = this.txtUserPwd.Text.Trim();
//è·å–çª—ä½“txtUserPwdæ§ä»¶ä¸­çš„æ•°æ®å¹¶è®¾ä¸ºuser_pwd
var re_user_pwd = this.txtReUserPwd.Text.Trim();
//è·å–çª—ä½“txtReUserPwdæ§ä»¶ä¸­çš„æ•°æ®å¹¶è®¾ä¸ºre_user_pwd

if (user_no == "")
{
    MessageBox.Show("ç”¨æˆ·åä¸èƒ½ä¸ºç©º!");
    return;
}

if (user_name == "")
{
    {
        MessageBox.Show("ç”¨æˆ·å§“åä¸èƒ½ä¸ºç©º!");
        return;
    }
    //å‡è®¾æ£€æµ‹åˆ°é‡Œé¢æ²¡æœ‰æ•°æ®ï¼Œå°±æç¤ºç”¨æˆ·åä¸èƒ½ä¸ºç©º!å¹¶åœæ­¢ç¨‹åº             
}
if (user_pwd == "")
{
    MessageBox.Show("ç”¨æˆ·åä¸èƒ½ä¸ºç©º!");
    return;
}

if (re_user_pwd != user_pwd)
{
    MessageBox.Show("ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´!");
    return;
}
{% endhighlight %}

è·Ÿç™»å½•ä¸€æ ·ï¼Œè·å–æ§ä»¶é‡Œé¢çš„å€¼å¹¶è¿›è¡Œåˆ¤æ–­ï¼Œè¿™é‡Œå¯¹æ¯”å‰é¢å¤šå†™äº†ä¸€ä¸ªå¯†ç é‡å¤åˆ¤æ–­

å†™å®Œé‡å¤åˆ¤æ–­å°±è¿›è¡Œç”¨æˆ·æ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­

{% highlight bash %}
//åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
{
    {
        List<SqlParameter> parameters = new List<SqlParameter>(); //åˆ›å»ºå‚æ•°åˆ—è¡¨
        parameters.Add(new SqlParameter { ParameterName = "user_no", Value = user_no, DbType = DbType.String });
        var dt = SqlHelper.ExecuteQuery($@"select * from UserInfo where user_no=@user_no", parameters.ToArray());
        if (dt != null && dt.Rows.Count > 0)
        {
            MessageBox.Show("ç”¨æˆ·åå·²å­˜åœ¨!");
            return;
        }
    }
}
{% endhighlight %}

è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ•°æ®åº“æ“ä½œå¤§éƒ¨åˆ†éƒ½æ˜¯æ ¹æ®user_noæ¥è¿›è¡ŒæŸ¥è¯¢çš„ï¼Œè¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œä¸€èˆ¬æŸ¥è¯¢æœ€å¥½ä½¿ç”¨Guidæ¯”è¾ƒå¥½ï¼Œå› ä¸ºGuidæ˜¯å…¨ä¸–ç•Œå”¯ä¸€çš„ï¼Œä¸å¯æ›´æ”¹çš„ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿æˆ‘å…ˆæ‹¿user_noæ¥ä¸¾ä¾‹

åˆ¤æ–­å®Œç”¨æˆ·åæ˜¯å¦å­˜åœ¨ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨æ¥å†™å¦‚æœä¸å­˜åœ¨çš„å¢åŠ é€»è¾‘

{% highlight bash %}
//å¾€æ•°æ®åº“é‡Œé¢æ’å…¥user_no,user_name,user_pwdä¸­çš„è¿™ä¸‰ä¸ªå­—æ®µï¼Œä»£è¡¨æŠŠç”¨æˆ·æ³¨å†Œçš„è´¦æˆ·æ³¨å…¥æ•°æ®åº“
{
    {
        List<SqlParameter> parameters = new List<SqlParameter>();
        parameters.Add(new SqlParameter { ParameterName = "user_no", Value = user_no, DbType = DbType.String });
        parameters.Add(new SqlParameter { ParameterName = "user_name", Value = user_name, DbType = DbType.String });
        parameters.Add(new SqlParameter { ParameterName = "user_pwd", Value = user_pwd, DbType = DbType.String });
        SqlHelper.ExecuteNonQuery($@"insert into UserInfo(user_no,user_name,user_pwd)values(@user_no,@user_name,@user_pwd)", parameters.ToArray());

        MessageBox.Show("æ³¨å†ŒæˆåŠŸ!");

        this.Close();
    }
}
{% endhighlight %}

å¥½çš„ï¼Œåˆ¤æ–­å®Œä¸å­˜åœ¨ä¹‹åå‘¢ï¼Œæˆ‘ä»¬å°±æ¥è¿›è¡Œä¸€ä¸ªæ’å…¥çš„æ“ä½œ

> **æ³¨æ„æ’å…¥çš„è¯­æ³•ï¼Œè·ŸæŸ¥è¯¢ä¸ä¸€æ ·ï¼Œè¿™é‡Œæˆ‘è®²è§£ä¸€ä¸‹æˆ‘ä»¬å¢åˆ æ”¹æŸ¥(CRUD)çš„å››ç§è¯­æ³•**
> **æŸ¥è¯¢(select)**
> **å¢åŠ (insert)**
> **ä¿®æ”¹,ä¹Ÿå¯ä»¥å«æ›´æ–°(update)**
> **åˆ é™¤(delete)**

è¿™æ ·å‘¢ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æ³¨å†Œé¡µé¢çš„ä»£ç é€»è¾‘äº†

#### 4.æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥åšä¸»é¡µé¢

> **è¿™ä¸ªä¸»é¡µæœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ’æŒ‰é’®æ ï¼Œç„¶åä¸‹é¢å†…åµŒä¸€ä¸ªæ–°çš„å¢åˆ æ”¹çª—ä½“**

> **æˆ‘ä»¬éœ€è¦å››ä¸ªæ–°çš„æ§ä»¶,barManager,XtraTabbedMdiManager,dockManager,navbarcontrol**

![](/assets/img/1751246312380.jpg)

barManageræ”¾åœ¨æœ€é¡¶ä¸Šï¼Œç‚¹å‡»ä¸Šé¢çš„addæ‹‰åˆ°æœ€ä½æœ‰ä¸€ä¸ªskinæ§ä»¶ï¼Œç‚¹å‡»ä»–ç„¶åæ‰“å¼€å±•å¼€æ¡†ç‚¹å‡»skinmenué€‰æ‹©ä»–ï¼Œç„¶åå³é”®è¿™ä¸ªæ§ä»¶æ‰¾åˆ°pointStyleè¿™ä¸ªå±æ€§ç»™ä»–æ”¹æˆCaptionGlyphï¼Œç„¶åç»§ç»­æ‰¾å±æ€§æ 

åœ¨é‡Œé¢æ‰¾åˆ°è¿™ä¸ªimages,ç‚¹å‡»æ—è¾¹çš„+å·

![](/assets/img/1751247517674.png)

ç‚¹å‡»ä¸‹é¢çš„imageæ—è¾¹åº”è¯¥æœ‰ä¸ªå°ä¸‰ç‚¹çš„ï¼Œç‚¹å‡»ä»–ï¼Œåœ¨é‡Œé¢é€‰æ‹©ä»€ä¹ˆæ å›¾æ ‡éƒ½å¯ä»¥

æŒ‰ç…§æˆ‘è¿™æ ·æ”¾ï¼Œæˆ–è€…ä½ ä»¬è‡ªç”±åˆ›æ„

**è¿™å››ä¸ªæ§ä»¶çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆå‘¢?**

>**1.barManager,ä¸€ä¸ªæŒ‰é’®æ ï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰æŒ‰é’®è¿˜æœ‰DevExpressçš„æŒ‰é’®**
**2.XtraTabbedMdiManager,è¿™ä¸ªæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ§ä»¶ï¼Œæˆ‘ä»¬å†…åµŒçª—ä½“å°±é è¿™ä¸ªæ§ä»¶**
**3.dockManager,è¿™ä¸ªæ§ä»¶æˆ‘ä»¬æ˜¯ç”¨æ¥åšäºŒçº§èœå•çš„ï¼Œè¿™ä¸ªæ˜¯ä¸€çº§èœå•**
**4.navbarControl,è¿™ä¸ªæ§ä»¶å°±æ˜¯æ‹¿æ¥åšäºŒçº§èœå•çš„ï¼Œå¾…ä¼šæˆ‘ä»¬è¿˜éœ€è¦ç»™ä»–æ·»åŠ ä¸€ä¸ªç‚¹å‡»äº‹ä»¶**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰¾åˆ°ä»–çš„ç‚¹å‡»äº‹ä»¶

![](/assets/img/1751246657419.jpg)

ç„¶ååœ¨é—ªç”µå›¾æ ‡é‡Œé¢æ‰¾åˆ°è¿™ä¸ªLinkClickedç‚¹å‡»äº‹ä»¶

![](/assets/img/1751249604151.png)

åŒå‡»ä»–ï¼Œç„¶ååœ¨æ‰“å¼€çš„é¡µé¢å†™ä¸€ä¸ªæ–°çª—ä½“çš„é€»è¾‘

{% highlight bash %}
var frm = new FrmUserList();   
frm.MdiParent = this;
frm.Show();
{% endhighlight %}

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„ä¸»é¡µçª—ä½“çœ‹åˆ°æˆ‘ä»¬çš„è¿™ä¸ªFrmUserListçš„çª—ä½“äº†

#### 5.æˆ‘ä»¬ç°åœ¨å°±åšå¢åˆ æ”¹æŸ¥é€»è¾‘çš„ä¸»é¡µ

æˆ‘ä»¬ç°åœ¨å·²ç»åšå®Œäº†ç™»å½•æ³¨å†Œè¿˜æœ‰æˆ‘ä»¬å¢åˆ æ”¹æŸ¥ä¸­çš„å¢äº†ï¼Œç°åœ¨æˆ‘ä»¬è¦å¼€å§‹è¿›è¡Œåˆ æ”¹æŸ¥ï¼Œå¦å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®¾è®¡æ•°æ®å¯è§†åŒ–

æˆ‘ä»¬åˆ›æ·ä¸€ä¸ªåä¸ºFrmUserList(ç”¨æˆ·åˆ—è¡¨)çš„çª—ä½“

> **æˆ‘ä»¬è¿™é‡Œéœ€è¦GridControlè¿™ä¸ªæ§ä»¶ï¼Œè¿™ä¸ªæ§ä»¶éå¸¸é‡è¦ï¼Œå¯ä»¥è¿æ¥æ•°æ®åº“æ˜¾ç¤ºåˆ—è¡¨ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ˜¾ç¤ºåˆ—è¡¨ä¸­çš„å“ªäº›æ•°æ®å¯ä»¥æ˜¾ç¤ºå“ªäº›æ•°æ®ä¸èƒ½æ˜¾ç¤º**

é¦–å…ˆå¯ä»¥å°è£…ä¸€ä¸ªæ•°æ®åº“è®¿é—®æ“ä½œï¼Œè®¿é—®æ•°æ®åº“æ‰€æœ‰å­—æ®µ

{% highlight bash %}
 List<SqlParameter>parameters = new List<SqlParameter>();
 var dt = SqlHelper.ExecuteQuery($@"select * from UserInfo",parameters.ToArray());
 this.gridControl.DataSource = dt;
 //ç»™LoadDataé™„ä¸Šæ¯æ¬¡ä½¿ç”¨è¿™æ®µä»£ç æ—¶æ‰§è¡ŒæŸ¥è¯¢æ•°æ®åº“ä»¥å®ç°åˆ·æ–°åŠŸèƒ½
{% endhighlight %}

è¿™æ ·å­ï¼Œæˆ‘ä»¬æ¯æ¬¡çš„æ•°æ®è®¿é—®åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ“ä½œç±»å°±å¯ä»¥è¿›è¡Œäº†ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„åˆ·æ–°å°±å¯ä»¥ç›´æ¥è°ƒç”¨ä»–

æ¥ä¸‹æ¥å†™ä¸‰ä¸ªæ§ä»¶çš„ç‚¹å‡»äº‹ä»¶

{% highlight bash %}
private void FrmUserList_Load(object sender, EventArgs e)
{
    LoadData();
}

private void btnAdd_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
{
    var frm = new FrmUserEdit();
    frm.ShowDialog();
    //è·³è½¬åˆ°FrmUserEdit

    LoadData();
}

private void btnDelete_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
{
    //æ£€æµ‹æ˜¯å¦é€‰ä¸­è¡Œ
    var Row = this.gridView.GetFocusedDataRow();
    if (Row == null)
    {
        MessageBox.Show("è¯·é€‰æ‹©è¦åˆ é™¤çš„è¡Œ!");
        return;
    }
    //æ£€æµ‹ç”¨æˆ·æœ‰æ— é€‰æ‹©ï¼Œå¦‚æ— ï¼Œåˆ™æç¤ºè¯·é€‰æ‹©è¦åˆ é™¤çš„è¡Œ!å¹¶ç»ˆæ­¢ç¨‹åº

    var dia = MessageBox.Show("æ˜¯å¦ç¡®è®¤åˆ é™¤!", "è­¦å‘Š!", MessageBoxButtons.YesNo);
    if (dia == DialogResult.Yes)
    {
        var user_no = Convert.ToString(Row["user_no"]);
        //è¿™æ®µä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ä» Row å¯¹è±¡é‡Œæå–åä¸º "user_no" çš„å€¼ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªå€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œæœ€åå°†è½¬æ¢åçš„å­—ç¬¦ä¸²èµ‹å€¼ç»™å˜é‡ user_noã€‚

        List<SqlParameter> parameters = new List<SqlParameter>();   
        parameters.Add(new SqlParameter { ParameterName = "user_no" , Value = user_no ,DbType=DbType.String});
        SqlHelper.ExecuteNonQuery($@"delete from UserInfo where user_no=@user_no",parameters.ToArray());
        //ä½¿ç”¨deleteå‘½ä»¤æŠŠè¿™æ®µå­—ç¬¦ä¸²ä»æ•°æ®åº“åˆ é™¤

        MessageBox.Show("åˆ é™¤æˆåŠŸ!");

        LoadData();
        //æ‰§è¡Œåˆšåˆšè®¾å®šå¥½çš„åˆ·æ–°å‘½ä»¤
    }
}

private void btnUserEdit_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
{
    //æ£€æµ‹æ˜¯å¦é€‰ä¸­è¡Œ
    var Row = this.gridView.GetFocusedDataRow();
    if (Row == null)
    {
        MessageBox.Show("è¯·é€‰æ‹©è¦ç¼–è¾‘çš„è¡Œ!");
        return;
    }
    //æ£€æµ‹ç”¨æˆ·æœ‰æ— é€‰æ‹©ï¼Œå¦‚æ— ï¼Œåˆ™æç¤ºè¯·é€‰æ‹©è¦ç¼–è¾‘çš„è¡Œ!å¹¶ç»ˆæ­¢ç¨‹åº

    //ä¼ é€’ç”¨æˆ·ç¼–å·åˆ°FrmUserEditç¼–è¾‘çª—ä½“
    var user_no = Convert.ToString(Row["user_no"]);

    var frm = new FrmUserEdit(user_no);
    //æ³¨æ„ï¼Œæ­¤user_noæ˜¯å°†åœ¨FrmUserEditä¸­æ–°å¢çš„ä¸€ä¸ªâ€‹å¸¦å‚æ•°çš„æ„é€ å‡½æ•°: æ¥æ”¶ user_no å‚æ•°ï¼Œç”¨äºåŒºåˆ† â€‹æ–°å¢ è¿˜æ˜¯ â€‹ç¼–è¾‘ æ¨¡å¼ï¼š,å¦‚FrmUserEditæœªå¢åŠ è¿™ä¸ªæ„é€ å‚æ•°åˆ™ä¼šæŠ¥é”™ï¼
    frm.ShowDialog();

    LoadData(); //å…³é—­ååˆ·æ–°åˆ—è¡¨
}
{% endhighlight %}

**ç°åœ¨æˆ‘ä»¬æ¥è®²è§£è¿™ä¸ªä»£ç çš„å®ç°é€»è¾‘**

**1.ä¿®æ”¹**
é¦–å…ˆï¼Œç¨‹åºé€šè¿‡`GetFocusedDataRow()`æ–¹æ³•è·å–`GridView`å½“å‰é€‰ä¸­çš„è¡Œ(ä¹Ÿå°±æ˜¯æˆ‘é€‰ä¸­çš„è¡Œ),å¹¶å°†å…¶èµ‹å€¼å˜é‡ç»™`Row`


æ¥ç€åˆ¤æ–­`Row`æ˜¯å¦ä¸ºç©º

    å¦‚æœä¸ºç©ºï¼Œåˆ™å¼¹å‡ºæç¤ºæ¡†ç„¶åç»ˆæ­¢ç¨‹åºæ“ä½œ
     
    å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜ç”¨æˆ·å·²ç»é€‰ä¸­äº†ä¸€è¡Œæ•°æ®ï¼Œç»§ç»­ä¸‹ä¸€æ­¥

ä»é€‰ä¸­çš„`Row`ä¸­å–å‡º`user_no`å­—æ®µï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œèµ‹å€¼ç»™æˆ‘ä»¬å£°æ˜è¿‡çš„å˜é‡user_no
è¿™ä¸ªuser_noä¼šä½œä¸ºå‚æ•°ä¼ å…¥æ–°çª—ä½“ï¼Œç„¶åæ–°çª—ä½“å†è¿›è¡Œåˆ¤æ–­

**2.æ–°å¢**
æ–°å¢æ“ä½œé€»è¾‘å¾ˆç®€å•ï¼Œç›´æ¥å¼¹å‡ºæ–°çª—ä½“å¹¶æ˜¾ç¤º
æ–°çª—ä½“ä¸­ä¼šåˆ¤æ–­è¿™ä¸ªæ˜¯æ–°å¢è¿˜æ˜¯ç¼–è¾‘ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„é€»è¾‘

**3.åˆ é™¤**
åˆ é™¤æ“ä½œè·Ÿä¸Šé¢ä¸€æ ·åŒæ ·éœ€è¦`GetFocusedDataRow()`è·å–è¡Œå¹¶èµ‹å€¼
ç„¶ååˆ¤æ–­`Row`æ˜¯å¦ä¸ºç©ºï¼Œå¦‚ä¸ºç©ºåˆ™ç»ˆæ­¢ï¼Œä¸ä¸ºç©ºåˆ™è¿›è¡Œæœ€åä¸€æ¬¡è­¦å‘Šé˜²æ­¢è¯¯åˆ é™¤
å¦‚ç”¨æˆ·ç¡®è®¤åˆ é™¤ï¼Œåˆ™ä»`Row`è·å–user_noçš„å€¼å¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ï¼Œç„¶åå¼€å§‹æ‰§è¡Œåˆ é™¤æ“ä½œ


{% highlight bash %}
List<SqlParameter> parameters = new List<SqlParameter>();   
parameters.Add(new SqlParameter { ParameterName = "user_no" , Value = user_no ,DbType=DbType.String});
SqlHelper.ExecuteNonQuery($@"delete from UserInfo where user_no=@user_no",parameters.ToArray());
//ä½¿ç”¨deleteå‘½ä»¤æŠŠè¿™æ®µå­—ç¬¦ä¸²ä»æ•°æ®åº“åˆ é™¤
{% endhighlight %}





